$code=@'
import ssl, socket
host="repo.anaconda.com"
ctx=ssl.SSLContext(ssl.PROTOCOL_TLS_CLIENT)
ctx.check_hostname=False
ctx.verify_mode=ssl.CERT_NONE
with socket.create_connection((host,443),timeout=10) as s:
    with ctx.wrap_socket(s,server_hostname=host) as ss:
        chain = ss.get_unverified_chain()
        print("chain_len=", len(chain))
        for i, cert in enumerate(chain):
            pem = ssl.DER_cert_to_PEM_cert(cert)
            # write each cert to a temp file and decode using the built-in test decoder
            import tempfile, pathlib
            p = pathlib.Path(tempfile.gettempdir()) / f"c{i}.pem"
            p.write_text(pem)
            d = ssl._ssl._test_decode_cert(str(p))
            print(f"[{i}] subject=", d.get("subject"))
            print(f"[{i}] issuer =", d.get("issuer"))
'@
$code | & "C:\ProgramData\anaconda3\python.exe" -
