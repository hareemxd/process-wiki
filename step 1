$ca = "C:\Users\David.Ricart\certs\cacert_with_zscaler.pem"

$code = @"
import ssl, socket
host = "repo.anaconda.com"
ctx = ssl.create_default_context(cafile=r"$ca")
with socket.create_connection((host, 443), timeout=10) as s:
    with ctx.wrap_socket(s, server_hostname=host) as ss:
        print("TLS OK")
        cert = ss.getpeercert()
        print("SUBJECT:", cert.get("subject"))
        print("ISSUER:", cert.get("issuer"))
"@

$code | & "C:\ProgramData\anaconda3\python.exe" -
